/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package solace.library;

import com.itextpdf.text.FontFactory;
import com.itextpdf.text.Paragraph;
import com.itextpdf.text.pdf.PdfWriter;
import java.awt.Font;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.io.File;
import java.io.FileOutputStream;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.text.Document;

/**
 *
 * @author sachith
 */
public class Book_Transactions extends javax.swing.JPanel {

    /**
     * Creates new form Book_Transactions
     */
    
    Connection con = null;
    PreparedStatement pst = null;
    ResultSet rs = null;
    
    GridBagLayout layout = new GridBagLayout();
    
    Fine_Calculation fine;
    
    public Book_Transactions() {
        initComponents();
        
        //connect to DB
        con = DBconnection.connect();
        
        
        
        pnl_fine.setVisible(false);
        lbl_back2.setVisible(false);
        
        fine = new Fine_Calculation();
        
        pnl_fine.setLayout(layout);
        //Books panel
        GridBagConstraints c = new GridBagConstraints();
        c.gridx = 0;
        c.gridy = 0;
        pnl_fine.add(fine,c);
        
        date();
        
        lbl_Notavailable.setVisible(false);
        lbl_available.setVisible(false);
        lbl_reserved.setVisible(false);
    }
    
    public void date(){
        
        Date date = new Date();
        //jdtp_bu_ReDate.setDate(date);
        jdtp_bu_date.setDate(date);
        //jdtp_re_Returned.setDate(date);
        jdtp_re_date.setDate(date);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        lbl_back2 = new javax.swing.JLabel();
        lbl_bktransaction = new javax.swing.JLabel();
        lbl_bktransaction_icon = new javax.swing.JLabel();
        pnl_burrow = new javax.swing.JPanel();
        lbl_Dashboard14 = new javax.swing.JLabel();
        txt_Bu_ISBN = new javax.swing.JTextField();
        lbl_Dashboard16 = new javax.swing.JLabel();
        txt_bu_bkname = new javax.swing.JTextField();
        lbl_Dashboard17 = new javax.swing.JLabel();
        txt_bu_memID = new javax.swing.JTextField();
        lbl_Dashboard18 = new javax.swing.JLabel();
        txt_bu_memName = new javax.swing.JTextField();
        lbl_Dashboard19 = new javax.swing.JLabel();
        jdtp_bu_date = new com.toedter.calendar.JDateChooser();
        lbl_reserved = new javax.swing.JLabel();
        jdtp_bu_ReDate = new com.toedter.calendar.JDateChooser();
        lbl_Dashboard21 = new javax.swing.JLabel();
        lbl_Dashboard22 = new javax.swing.JLabel();
        lbl_Notavailable = new javax.swing.JLabel();
        lbl_available = new javax.swing.JLabel();
        btn_borrowed = new javax.swing.JButton();
        pnl_return = new javax.swing.JPanel();
        lbl_Dashboard25 = new javax.swing.JLabel();
        txt_re_ISBN = new javax.swing.JTextField();
        txt_re_memID = new javax.swing.JTextField();
        lbl_Dashboard29 = new javax.swing.JLabel();
        lbl_Dashboard26 = new javax.swing.JLabel();
        jdtp_re_date = new com.toedter.calendar.JDateChooser();
        txt_re_memName = new javax.swing.JTextField();
        lbl_Dashboard28 = new javax.swing.JLabel();
        jdtp_re_Returned = new com.toedter.calendar.JDateChooser();
        lbl_Dashboard30 = new javax.swing.JLabel();
        lbl_Dashboard27 = new javax.swing.JLabel();
        txt_re_bkName = new javax.swing.JTextField();
        btn_fincal = new javax.swing.JButton();
        lbl_Belated = new javax.swing.JLabel();
        btn_markReturn = new javax.swing.JButton();
        lbl_finetot1 = new javax.swing.JLabel();
        lbl_Dashboard34 = new javax.swing.JLabel();
        lbl_Dashboard35 = new javax.swing.JLabel();
        txt_cost = new javax.swing.JTextField();
        lbl_Dashboard36 = new javax.swing.JLabel();
        btn_printR = new javax.swing.JButton();
        pnl_fine = new javax.swing.JPanel();

        setBackground(new java.awt.Color(242, 242, 242));
        setPreferredSize(new java.awt.Dimension(930, 590));
        setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lbl_back2.setFont(new java.awt.Font("Century Gothic", 0, 18)); // NOI18N
        lbl_back2.setForeground(new java.awt.Color(30, 25, 24));
        lbl_back2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/back-arrow.png"))); // NOI18N
        lbl_back2.setText("Back");
        lbl_back2.setToolTipText("");
        lbl_back2.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        lbl_back2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                lbl_back2MouseClicked(evt);
            }
        });
        add(lbl_back2, new org.netbeans.lib.awtextra.AbsoluteConstraints(80, 500, -1, -1));

        lbl_bktransaction.setFont(new java.awt.Font("Century Gothic", 0, 18)); // NOI18N
        lbl_bktransaction.setForeground(new java.awt.Color(105, 105, 105));
        lbl_bktransaction.setText("Book Transactions");
        add(lbl_bktransaction, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 20, 170, 20));

        lbl_bktransaction_icon.setFont(new java.awt.Font("Century Gothic", 0, 18)); // NOI18N
        lbl_bktransaction_icon.setForeground(new java.awt.Color(105, 105, 105));
        lbl_bktransaction_icon.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/book-return-box.png"))); // NOI18N
        add(lbl_bktransaction_icon, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 40, 40));

        pnl_burrow.setBackground(new java.awt.Color(52, 181, 90));
        pnl_burrow.setBorder(javax.swing.BorderFactory.createTitledBorder(new javax.swing.border.LineBorder(new java.awt.Color(255, 255, 255), 2, true), "Burrow", javax.swing.border.TitledBorder.CENTER, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Century Gothic", 1, 18), new java.awt.Color(255, 255, 255))); // NOI18N
        pnl_burrow.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lbl_Dashboard14.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard14.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard14.setText("ISBN:");
        pnl_burrow.add(lbl_Dashboard14, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 30, 110, 20));

        txt_Bu_ISBN.setBackground(new java.awt.Color(255, 255, 255));
        txt_Bu_ISBN.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_Bu_ISBN.setForeground(new java.awt.Color(69, 73, 74));
        txt_Bu_ISBN.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        txt_Bu_ISBN.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txt_Bu_ISBNKeyReleased(evt);
            }
        });
        pnl_burrow.add(txt_Bu_ISBN, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 30, 240, -1));

        lbl_Dashboard16.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard16.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard16.setText("Book Name:");
        pnl_burrow.add(lbl_Dashboard16, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 70, 100, 20));

        txt_bu_bkname.setBackground(new java.awt.Color(255, 255, 255));
        txt_bu_bkname.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_bu_bkname.setForeground(new java.awt.Color(69, 73, 74));
        txt_bu_bkname.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        pnl_burrow.add(txt_bu_bkname, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 70, 240, -1));

        lbl_Dashboard17.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard17.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard17.setText("Member ID:");
        pnl_burrow.add(lbl_Dashboard17, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 120, 100, 20));

        txt_bu_memID.setBackground(new java.awt.Color(255, 255, 255));
        txt_bu_memID.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_bu_memID.setForeground(new java.awt.Color(69, 73, 74));
        txt_bu_memID.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        txt_bu_memID.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txt_bu_memIDKeyReleased(evt);
            }
        });
        pnl_burrow.add(txt_bu_memID, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 120, 240, -1));

        lbl_Dashboard18.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard18.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard18.setText("Date:");
        pnl_burrow.add(lbl_Dashboard18, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 220, 130, 20));

        txt_bu_memName.setBackground(new java.awt.Color(255, 255, 255));
        txt_bu_memName.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_bu_memName.setForeground(new java.awt.Color(69, 73, 74));
        txt_bu_memName.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        pnl_burrow.add(txt_bu_memName, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 170, 240, -1));

        lbl_Dashboard19.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard19.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard19.setText("Member Name:");
        pnl_burrow.add(lbl_Dashboard19, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 170, 130, 20));

        jdtp_bu_date.setBackground(new java.awt.Color(255, 255, 255));
        pnl_burrow.add(jdtp_bu_date, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 220, 240, -1));

        lbl_reserved.setFont(new java.awt.Font("Century Gothic", 1, 16)); // NOI18N
        lbl_reserved.setForeground(new java.awt.Color(0, 51, 255));
        lbl_reserved.setText("Reserved");
        pnl_burrow.add(lbl_reserved, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 330, 80, 20));

        jdtp_bu_ReDate.setBackground(new java.awt.Color(255, 255, 255));
        pnl_burrow.add(jdtp_bu_ReDate, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 270, 240, -1));

        lbl_Dashboard21.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard21.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard21.setText("Return Date:");
        pnl_burrow.add(lbl_Dashboard21, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 270, 130, 20));

        lbl_Dashboard22.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard22.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard22.setText("Status:");
        pnl_burrow.add(lbl_Dashboard22, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 330, 90, 20));

        lbl_Notavailable.setFont(new java.awt.Font("Century Gothic", 1, 16)); // NOI18N
        lbl_Notavailable.setForeground(new java.awt.Color(255, 0, 0));
        lbl_Notavailable.setText("Not Available");
        pnl_burrow.add(lbl_Notavailable, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 330, 120, 20));

        lbl_available.setFont(new java.awt.Font("Century Gothic", 1, 16)); // NOI18N
        lbl_available.setForeground(new java.awt.Color(255, 255, 153));
        lbl_available.setText("Available");
        pnl_burrow.add(lbl_available, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 330, 80, 20));

        btn_borrowed.setBackground(new java.awt.Color(255, 255, 255));
        btn_borrowed.setForeground(new java.awt.Color(52, 181, 90));
        btn_borrowed.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/burrowbk.png"))); // NOI18N
        btn_borrowed.setText("Mark Borrowed");
        btn_borrowed.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_borrowedMouseClicked(evt);
            }
        });
        pnl_burrow.add(btn_borrowed, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 400, 150, 40));

        add(pnl_burrow, new org.netbeans.lib.awtextra.AbsoluteConstraints(40, 60, 400, 520));

        pnl_return.setBackground(new java.awt.Color(0, 85, 127));
        pnl_return.setBorder(javax.swing.BorderFactory.createTitledBorder(new javax.swing.border.LineBorder(new java.awt.Color(255, 255, 255), 2, true), "Return", javax.swing.border.TitledBorder.CENTER, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Century Gothic", 1, 18), new java.awt.Color(255, 255, 255))); // NOI18N
        pnl_return.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        lbl_Dashboard25.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard25.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard25.setText("ISBN:");
        pnl_return.add(lbl_Dashboard25, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 30, 110, 20));

        txt_re_ISBN.setBackground(new java.awt.Color(255, 255, 255));
        txt_re_ISBN.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_re_ISBN.setForeground(new java.awt.Color(69, 73, 74));
        txt_re_ISBN.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        txt_re_ISBN.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txt_re_ISBNKeyReleased(evt);
            }
        });
        pnl_return.add(txt_re_ISBN, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 30, 240, -1));

        txt_re_memID.setBackground(new java.awt.Color(255, 255, 255));
        txt_re_memID.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_re_memID.setForeground(new java.awt.Color(69, 73, 74));
        txt_re_memID.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        pnl_return.add(txt_re_memID, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 120, 240, -1));

        lbl_Dashboard29.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard29.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard29.setText("Returned date:");
        pnl_return.add(lbl_Dashboard29, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 220, 130, 20));

        lbl_Dashboard26.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard26.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard26.setText("Book Name:");
        pnl_return.add(lbl_Dashboard26, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 70, 100, 20));

        jdtp_re_date.setBackground(new java.awt.Color(255, 255, 255));
        pnl_return.add(jdtp_re_date, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 270, 240, -1));

        txt_re_memName.setBackground(new java.awt.Color(255, 255, 255));
        txt_re_memName.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_re_memName.setForeground(new java.awt.Color(69, 73, 74));
        txt_re_memName.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        pnl_return.add(txt_re_memName, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 170, 240, -1));

        lbl_Dashboard28.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard28.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard28.setText("Member Name:");
        pnl_return.add(lbl_Dashboard28, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 170, 130, 20));

        jdtp_re_Returned.setBackground(new java.awt.Color(255, 255, 255));
        pnl_return.add(jdtp_re_Returned, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 220, 240, -1));

        lbl_Dashboard30.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard30.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard30.setText("Return Date:");
        pnl_return.add(lbl_Dashboard30, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 270, 130, 20));

        lbl_Dashboard27.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard27.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard27.setText("Member ID:");
        pnl_return.add(lbl_Dashboard27, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 120, 100, 20));

        txt_re_bkName.setBackground(new java.awt.Color(255, 255, 255));
        txt_re_bkName.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        txt_re_bkName.setForeground(new java.awt.Color(69, 73, 74));
        txt_re_bkName.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        pnl_return.add(txt_re_bkName, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 70, 240, -1));

        btn_fincal.setBackground(new java.awt.Color(255, 255, 255));
        btn_fincal.setForeground(new java.awt.Color(0, 85, 127));
        btn_fincal.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/finecal.png"))); // NOI18N
        btn_fincal.setText("Calculate Fine");
        btn_fincal.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_fincalMouseClicked(evt);
            }
        });
        pnl_return.add(btn_fincal, new org.netbeans.lib.awtextra.AbsoluteConstraints(250, 350, 140, 40));

        lbl_Belated.setFont(new java.awt.Font("Century Gothic", 1, 16)); // NOI18N
        lbl_Belated.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Belated.setText("0");
        pnl_return.add(lbl_Belated, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 360, 120, 20));

        btn_markReturn.setBackground(new java.awt.Color(255, 255, 255));
        btn_markReturn.setForeground(new java.awt.Color(0, 85, 127));
        btn_markReturn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/returnbk-box.png"))); // NOI18N
        btn_markReturn.setText("Mark Returned");
        btn_markReturn.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_markReturnMouseClicked(evt);
            }
        });
        pnl_return.add(btn_markReturn, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 460, 150, 40));

        lbl_finetot1.setFont(new java.awt.Font("Century Gothic", 1, 16)); // NOI18N
        lbl_finetot1.setForeground(new java.awt.Color(255, 255, 255));
        lbl_finetot1.setText("Rs: 0.00");
        pnl_return.add(lbl_finetot1, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 400, 120, 20));

        lbl_Dashboard34.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard34.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard34.setText("Belated Days :");
        pnl_return.add(lbl_Dashboard34, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 360, 120, 20));

        lbl_Dashboard35.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard35.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard35.setText("Fine per day:");
        pnl_return.add(lbl_Dashboard35, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 320, 120, 20));

        txt_cost.setBackground(new java.awt.Color(255, 255, 255));
        txt_cost.setFont(new java.awt.Font("Century Gothic", 0, 12)); // NOI18N
        txt_cost.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(105, 105, 105), 1, true));
        pnl_return.add(txt_cost, new org.netbeans.lib.awtextra.AbsoluteConstraints(150, 320, 240, 20));

        lbl_Dashboard36.setFont(new java.awt.Font("Century Gothic", 0, 16)); // NOI18N
        lbl_Dashboard36.setForeground(new java.awt.Color(255, 255, 255));
        lbl_Dashboard36.setText("Total fine:");
        pnl_return.add(lbl_Dashboard36, new org.netbeans.lib.awtextra.AbsoluteConstraints(20, 400, 120, 20));

        btn_printR.setBackground(new java.awt.Color(255, 255, 255));
        btn_printR.setForeground(new java.awt.Color(0, 85, 127));
        btn_printR.setIcon(new javax.swing.ImageIcon(getClass().getResource("/icon/printer slip2.png"))); // NOI18N
        btn_printR.setText("Print Recipt");
        btn_printR.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                btn_printRMouseClicked(evt);
            }
        });
        pnl_return.add(btn_printR, new org.netbeans.lib.awtextra.AbsoluteConstraints(250, 400, 140, 40));

        add(pnl_return, new org.netbeans.lib.awtextra.AbsoluteConstraints(490, 60, 400, 520));

        pnl_fine.setBackground(new java.awt.Color(242, 242, 242));
        pnl_fine.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());
        add(pnl_fine, new org.netbeans.lib.awtextra.AbsoluteConstraints(0, 0, 930, 590));
    }// </editor-fold>//GEN-END:initComponents

    private void btn_fincalMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_fincalMouseClicked
       /* pnl_fine.setVisible(true);
        pnl_burrow.setVisible(false);
        pnl_return.setVisible(false);
        lbl_bktransaction.setVisible(false);
        lbl_bktransaction_icon.setVisible(false);
        lbl_back2.setVisible(true);*/
       
       
       if(txt_re_ISBN.getText().isEmpty() ||txt_re_bkName.getText().isEmpty() || txt_re_memID.getText().isEmpty() || txt_re_memName.getText().isEmpty()){
           
           JOptionPane.showMessageDialog(null,"Please complete the form corectly");
       }
       
       else{
           
           SimpleDateFormat format = new SimpleDateFormat("dd-MM-yyyy");
        
        Date d1 =null;
        Date d2 =null;
        
        
        try {
            
            
            d1 = format.parse(format.format(jdtp_re_Returned.getDate()));
            d2 = format.parse(format.format(jdtp_re_date.getDate()));
            
            
            

            
        } catch (Exception e) {
            e.printStackTrace();
        }
        
        long diff = d2.getTime() - d1.getTime();
        long hours = diff/(60*60*1000);
        long days = hours/24;
        
        String d= Long.toString(days);
        
        if(d2.getTime() > d1.getTime()){
            
            lbl_Belated.setText(d); 
            
            
            double tot;
        
            
            if(txt_cost.getText().isEmpty()){
                
                JOptionPane.showMessageDialog(null,"Please Enter the Fines Per Day Amount ");
            }
            
            else{
                
                tot= Integer.parseInt(d) * Integer.parseInt(txt_cost.getText());
        
                 String fiinetot = Double.toString(tot);
        
                 lbl_finetot1.setText("Rs: "+fiinetot);
            }
        
        }
        
        else{
            lbl_Belated.setText("0");
            txt_cost.setText("0");
        }
       }
        
        
        
        
        
    }//GEN-LAST:event_btn_fincalMouseClicked

    private void lbl_back2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_lbl_back2MouseClicked
        pnl_fine.setVisible(false);
        pnl_burrow.setVisible(true);
        pnl_return.setVisible(true);
        lbl_bktransaction.setVisible(true);
        lbl_bktransaction_icon.setVisible(true);
        lbl_back2.setVisible(false);

    }//GEN-LAST:event_lbl_back2MouseClicked

    private void btn_borrowedMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_borrowedMouseClicked
        
        if(txt_Bu_ISBN.getText().isEmpty() || txt_bu_bkname.getText().isEmpty() || txt_bu_memID.getText().isEmpty() || txt_bu_memName.getText().isEmpty()){
            
            JOptionPane.showMessageDialog(null,"Please complete the form corectly");
        }
        
        else if(lbl_Notavailable.isVisible()==true){
            JOptionPane.showMessageDialog(null,txt_Bu_ISBN.getText()+"\n \nThis book is already borrowed");
        }
        
        else{
            
            //burrow book table
            
            try {
                
                //burrow book table
                String date = ((JTextField)jdtp_bu_date.getDateEditor().getUiComponent()).getText();
                String return_date = ((JTextField)jdtp_bu_ReDate.getDateEditor().getUiComponent()).getText();
                
                String insertaql="insert into burrow_book(ISBN,Book_Name,Member_ID,Name,date,return_date) values(?,?,?,?,?,?)";
                
                pst=con.prepareStatement(insertaql);
                
                 pst.setString(1,txt_Bu_ISBN.getText());
                pst.setString(2,txt_bu_bkname.getText());
                pst.setString(3,txt_bu_memID.getText());
                pst.setString(4,txt_bu_memName.getText());
                pst.setString(5,date);
                pst.setString(6,return_date);
                
                pst.execute();
                JOptionPane.showMessageDialog(null,"Borrowed");
                
                
                //update status
                
                int status=0;
                
                String updateaql="update books set status="+status+",borrower='"+txt_bu_memName.getText()+"' where ISBN='"+txt_Bu_ISBN.getText()+"'";
                pst = con.prepareStatement(updateaql);
                pst.execute();
                
               // JOptionPane.showMessageDialog(null,"Data Updated");
                
                txt_Bu_ISBN.setText("");
                txt_bu_bkname.setText("");
                txt_bu_memID.setText("");
                txt_bu_memName.setText("");
                jdtp_bu_ReDate.setCalendar(null);
                lbl_Notavailable.setVisible(false);
                lbl_available.setVisible(false);
                lbl_reserved.setVisible(false); 
                //jdtp_bu_date.setCalendar(null);
                
            } catch (Exception e) {
            }
        }
    }//GEN-LAST:event_btn_borrowedMouseClicked

    private void txt_Bu_ISBNKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_Bu_ISBNKeyReleased
        
        if(txt_Bu_ISBN.getText().isEmpty()){
            
            txt_bu_bkname.setText("");
            jdtp_bu_ReDate.setCalendar(null);
                //jdtp_bu_date.setCalendar(null);
            lbl_Notavailable.setVisible(false);
                lbl_available.setVisible(false);
                lbl_reserved.setVisible(false); 
                Date date = new Date();
            jdtp_bu_date.setDate(date);
            
        }
        
        try {
            
            String isbn=txt_Bu_ISBN.getText();
            int status;
            String selectsql="select * from books where ISBN='"+isbn+"'";
            pst=con.prepareStatement(selectsql);
            rs=pst.executeQuery();
            
            while(rs.next()){
                
                txt_bu_bkname.setText(rs.getString("Book_Name"));
                status=rs.getInt("status");
                
                if(status==0){
                lbl_Notavailable.setVisible(true);
                lbl_available.setVisible(false);
                lbl_reserved.setVisible(false); 
          }
                if(status==1){
                    lbl_Notavailable.setVisible(false);
                lbl_available.setVisible(true);
                lbl_reserved.setVisible(false); 
                }
                
                if(status==2){
                    lbl_Notavailable.setVisible(false);
                lbl_available.setVisible(false);
                lbl_reserved.setVisible(true);
                }
                
            }
            
            
            
        } catch (Exception e) {
        }
        
        
    }//GEN-LAST:event_txt_Bu_ISBNKeyReleased

    private void txt_bu_memIDKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_bu_memIDKeyReleased
        
        if(txt_bu_memID.getText().isEmpty()){
            
            txt_bu_memName.setText("");
        }
        
        try {
            
            String memID=txt_bu_memID.getText();
            
            String selectsql="select * from members where Member_ID='"+memID+"'";
            pst=con.prepareStatement(selectsql);
            rs=pst.executeQuery();
            
            while(rs.next()){
                
                txt_bu_memName.setText(rs.getString("Name"));
            }
            
        } catch (Exception e) {
        }
    }//GEN-LAST:event_txt_bu_memIDKeyReleased

    private void txt_re_ISBNKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_re_ISBNKeyReleased
        
        if(txt_re_ISBN.getText().isEmpty()){
            
            txt_re_bkName.setText("");
            txt_re_memID.setText("");
            txt_re_memName.setText("");
            lbl_Belated.setText("0");
            jdtp_re_Returned.setCalendar(null);
            txt_cost.setText("");
            lbl_finetot1.setText("Rs:0.0");
            Date date = new Date();
            jdtp_re_date.setDate(date);
            //jdtp_re_date.setCalendar(null);
            
        }
        
        try {
            
            String isbn=txt_re_ISBN.getText();
            
            String selectsql="select * from burrow_book where ISBN='"+isbn+"'";
            pst=con.prepareStatement(selectsql);
            rs=pst.executeQuery();
            
            while(rs.next()){                
                
                txt_re_bkName.setText(rs.getString("Book_Name"));
                txt_re_memID.setText(rs.getString("Member_ID"));
                txt_re_memName.setText(rs.getString("Name"));
                
                String date=rs.getString("return_date");
                ((JTextField)jdtp_re_Returned.getDateEditor().getUiComponent()).setText(date);
                
                
                
             
              SimpleDateFormat format = new SimpleDateFormat("dd-MM-yyyy");
        
        Date d1 =null;
        Date d2 =null;
        
        
        try {
            
            
            d1 = format.parse(format.format(jdtp_re_Returned.getDate()));
            d2 = format.parse(format.format(jdtp_re_date.getDate()));
            
            
            

            
        } catch (Exception e) {
            e.printStackTrace();
        }
        
        long diff = d2.getTime() - d1.getTime();
        long hours = diff/(60*60*1000);
        long days = hours/24;
        
        String d= Long.toString(days);
        
        if(d2.getTime() > d1.getTime()){
            
            lbl_Belated.setText(d); 
            
            double tot;
        
        tot= Integer.parseInt(d) * Integer.parseInt(txt_cost.getText());
        
        String fiinetot = Double.toString(tot);
        
        lbl_finetot1.setText("Rs: "+fiinetot);
        }
        
        else{
            lbl_Belated.setText("0");  
            lbl_finetot1.setText("Rs:0.0");
        }
        
        
                
                
            }
            
        } catch (Exception e) {
        }
        
    }//GEN-LAST:event_txt_re_ISBNKeyReleased

    private void btn_markReturnMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_markReturnMouseClicked
        
        if(txt_re_ISBN.getText().isEmpty() || txt_re_bkName.getText().isEmpty() || txt_re_memID.getText().isEmpty() || txt_re_memName.getText().isEmpty()){
            
            JOptionPane.showMessageDialog(null,"Please complete the form corectly");
        }
        
        else{
            
            try {
                
                //delete burrow book rable
                String ISBN = txt_re_ISBN.getText();
                
                String deleteq="delete from burrow_book where ISBN='"+ISBN+"'";
                pst = con.prepareStatement(deleteq);
                pst.execute();
                
                JOptionPane.showMessageDialog(null,"Returned");
                
                //update books table
                
                int status=1;
                
                
                
                String updateaql="update books set status="+status+",borrower='"+""+"' where ISBN='"+txt_re_ISBN.getText()+"'";
                pst = con.prepareStatement(updateaql);
                pst.execute();
                
                //JOptionPane.showMessageDialog(null,"Data Updated");
                
                txt_re_ISBN.setText("");
                txt_re_bkName.setText("");
                txt_re_memID.setText("");
                txt_re_memName.setText("");
                jdtp_re_Returned.setCalendar(null);
                txt_cost.setText("");
                lbl_Belated.setText("");
                lbl_finetot1.setText("");
                Date date = new Date();
                jdtp_re_date.setDate(date);
                
                
            } catch (Exception e) {
            }
        }
       
    }//GEN-LAST:event_btn_markReturnMouseClicked

    private void btn_printRMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_btn_printRMouseClicked
        
        if(txt_re_ISBN.getText().isEmpty() ||txt_re_bkName.getText().isEmpty() || txt_re_memID.getText().isEmpty() || txt_re_memName.getText().isEmpty()){
            
            JOptionPane.showMessageDialog(null,"Please complete the form corectly");
            
        }
        
        else{
            
            String isbn = txt_re_ISBN.getText();
            String bkname = txt_re_bkName.getText();
            String memberID = txt_re_memID.getText();
            String memName = txt_re_memName.getText();
            String cost = txt_cost.getText();
            String returned_date = ((JTextField)jdtp_re_Returned.getDateEditor().getUiComponent()).getText();
            String date = ((JTextField)jdtp_re_date.getDateEditor().getUiComponent()).getText();
            String BelatedD = lbl_Belated.getText();
            String totfine = lbl_finetot1.getText();
            
            
            JFileChooser dialog = new JFileChooser();
            dialog.setSelectedFile(new File(memberID +" "+ memName+"-Fine Slip"+".pdf"));
            int dialogResult = dialog.showSaveDialog(null);
            
            if(dialogResult==JFileChooser.APPROVE_OPTION){
                
             String filePath = dialog.getSelectedFile().getPath();
             
                try {
                    
                    
                 com.itextpdf.text.Document myDocument = new com.itextpdf.text.Document();
                 PdfWriter myWriter = PdfWriter.getInstance(myDocument, new FileOutputStream(filePath));
                 
                 myDocument.open();
                 
                 
                 
                 
                myDocument.add(new Paragraph("Solace Library",FontFactory.getFont(FontFactory.TIMES_BOLD,20,Font.BOLD )));
           myDocument.add(new Paragraph(new Date().toString()));
           myDocument.add(new Paragraph("-------------------------------------------------------------------------------------------"));
           myDocument.add((new Paragraph("MEMBER DETAILS",FontFactory.getFont(FontFactory.TIMES_ROMAN,15,Font.BOLD))));
           myDocument.add((new Paragraph("Member ID: "+memberID,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN))));
           myDocument.add((new Paragraph("Name of Member: "+memName,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN))));
           
           myDocument.add(new Paragraph("-------------------------------------------------------------------------------------------"));
           myDocument.add(new Paragraph("BOOK DETAILS",FontFactory.getFont(FontFactory.TIMES_ROMAN,15,Font.BOLD)));
           myDocument.add(new Paragraph("ISBN: "+isbn,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           myDocument.add(new Paragraph("Book Name: "+bkname,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           
           myDocument.add(new Paragraph("-------------------------------------------------------------------------------------------"));
           myDocument.add(new Paragraph("DATE",FontFactory.getFont(FontFactory.TIMES_ROMAN,15,Font.BOLD)));
           myDocument.add(new Paragraph("Returned date: "+returned_date,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           myDocument.add(new Paragraph("Return Date: "+date ,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           myDocument.add(new Paragraph("Belated Days: "+BelatedD ,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           myDocument.add(new Paragraph("-------------------------------------------------------------------------------------------"));
           myDocument.add(new Paragraph("TOTAL FINE",FontFactory.getFont(FontFactory.TIMES_ROMAN,15,Font.BOLD)));
           myDocument.add(new Paragraph("Fine per day: Rs "+cost,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           myDocument.add(new Paragraph("Total fine: "+totfine,FontFactory.getFont(FontFactory.TIMES_ROMAN,10,Font.PLAIN)));
           myDocument.add(new Paragraph("-------------------------------------------------------------------------------------------"));

           myDocument.close();
           
           JOptionPane.showMessageDialog(null,"Recipt was successfully generated");
                    
                } catch (Exception e) {
                    JOptionPane.showMessageDialog(null,e);
                }
                
            }
        }
        
            
    }//GEN-LAST:event_btn_printRMouseClicked


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btn_borrowed;
    private javax.swing.JButton btn_fincal;
    private javax.swing.JButton btn_markReturn;
    private javax.swing.JButton btn_printR;
    private com.toedter.calendar.JDateChooser jdtp_bu_ReDate;
    private com.toedter.calendar.JDateChooser jdtp_bu_date;
    private com.toedter.calendar.JDateChooser jdtp_re_Returned;
    private com.toedter.calendar.JDateChooser jdtp_re_date;
    private javax.swing.JLabel lbl_Belated;
    private javax.swing.JLabel lbl_Dashboard14;
    private javax.swing.JLabel lbl_Dashboard16;
    private javax.swing.JLabel lbl_Dashboard17;
    private javax.swing.JLabel lbl_Dashboard18;
    private javax.swing.JLabel lbl_Dashboard19;
    private javax.swing.JLabel lbl_Dashboard21;
    private javax.swing.JLabel lbl_Dashboard22;
    private javax.swing.JLabel lbl_Dashboard25;
    private javax.swing.JLabel lbl_Dashboard26;
    private javax.swing.JLabel lbl_Dashboard27;
    private javax.swing.JLabel lbl_Dashboard28;
    private javax.swing.JLabel lbl_Dashboard29;
    private javax.swing.JLabel lbl_Dashboard30;
    private javax.swing.JLabel lbl_Dashboard34;
    private javax.swing.JLabel lbl_Dashboard35;
    private javax.swing.JLabel lbl_Dashboard36;
    private javax.swing.JLabel lbl_Notavailable;
    private javax.swing.JLabel lbl_available;
    private javax.swing.JLabel lbl_back2;
    private javax.swing.JLabel lbl_bktransaction;
    private javax.swing.JLabel lbl_bktransaction_icon;
    private javax.swing.JLabel lbl_finetot1;
    private javax.swing.JLabel lbl_reserved;
    private javax.swing.JPanel pnl_burrow;
    private javax.swing.JPanel pnl_fine;
    private javax.swing.JPanel pnl_return;
    private javax.swing.JTextField txt_Bu_ISBN;
    private javax.swing.JTextField txt_bu_bkname;
    private javax.swing.JTextField txt_bu_memID;
    private javax.swing.JTextField txt_bu_memName;
    private javax.swing.JTextField txt_cost;
    private javax.swing.JTextField txt_re_ISBN;
    private javax.swing.JTextField txt_re_bkName;
    private javax.swing.JTextField txt_re_memID;
    private javax.swing.JTextField txt_re_memName;
    // End of variables declaration//GEN-END:variables
}
